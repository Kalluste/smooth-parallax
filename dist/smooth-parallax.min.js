!function(e,t){"function"==typeof define&&define.amd?define([],t(e)):"object"==typeof exports?module.exports=t(e):e.SmoothParallax=t(e)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";var t,r,n,i,o=e,a=0,c=0,l=[],s=[],u=["containerVisibility","pageScroll"],g={},d={basePercentageOn:"containerVisibility",decimalPrecision:2},f=function(){var e={},t=!1,r=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],r++);for(;r<n;r++)!function(r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t&&"[object Object]"===Object.prototype.toString.call(r[n])?e[n]=f(!0,e[n],r[n]):e[n]=r[n])}(arguments[r]);return e},p=function(e){var r=e.getAttribute("container");return t=e.parentNode,""!=r&&document.querySelector(r)&&(t=document.querySelector(r)),t},y=function(){var e=document.documentElement||document.body;return r=e.scrollHeight,(c=o.pageYOffset||e.scrollTop)/(r-e.clientHeight)},b=function(e){n=o.innerHeight,"containerVisibility"==i.basePercentageOn&&(r=e.container.scrollHeight,c=n-e.container.getBoundingClientRect().top,a=c/r),"pageScroll"==i.basePercentageOn&&(a=y()),a<0?a=0:a>1&&(a=1)},x=function(e){for(var t=0;t<s.length;t++)if(s[t].element==e)return s[t];return!1},m=function(){var e,t,r,n,i,o,a,c=["elementsize","containerSize"];l=document.querySelectorAll("[smooth-parallax]");for(var u=0;u<l.length;u++){e=parseFloat(l[u].getAttribute("start-movement"))||0,t=parseFloat(l[u].getAttribute("start-position-x"))||0,r=parseFloat(l[u].getAttribute("start-position-y"))||0,n=parseFloat(l[u].getAttribute("end-movement"))||1,i=parseFloat(l[u].getAttribute("end-position-x"))||0,o=parseFloat(l[u].getAttribute("end-position-y"))||0,a=l[u].getAttribute("base-size"),-1==c.indexOf(a)&&(a="elementSize");var g={element:l[u],container:p(l[u]),baseSizeOn:a,start:{percent:e,x:t,y:r},end:{percent:n,x:i,y:o},diff:{percent:n-e,x:i-t,y:o-r},target:{},current:{}};s.push(g)}},h=function(){for(var e=0;e<l.length;e++){var t,r,n=s[e];"elementSize"==n.baseSizeOn?(t=l[e].scrollWidth,r=l[e].scrollHeight):"containerSize"==n.baseSizeOn&&(t=n.container.scrollWidth-l[e].scrollWidth,r=n.container.scrollHeight-l[e].scrollHeight),b(n),a<=n.start.percent?(n.target.x=n.start.x*t,n.target.y=n.start.y*r):a>=n.end.percent?(n.target.x=n.end.x*t,n.target.y=n.end.y*r):(n.target.x=n.start.x*t+n.diff.x*(a-n.start.percent)/n.diff.percent*t,n.target.y=n.start.y*r+n.diff.y*(a-n.start.percent)/n.diff.percent*r),n.current.x&&n.current.y?(n.current.x=n.current.x+.1*(n.target.x-n.current.x),n.current.y=n.current.y+.1*(n.target.y-n.current.y)):(n.current.x=n.target.x,n.current.y=n.target.y),n.current.x=parseFloat(n.current.x.toFixed(i.decimalPrecision)),n.current.y=parseFloat(n.current.y.toFixed(i.decimalPrecision)),l[e].style.transform="translate3d("+n.current.x+"px, "+n.current.y+"px, 0)"}},v=function(){h(),requestAnimationFrame(v)},O=function(){var e=!0;return-1==u.indexOf(i.basePercentageOn)&&(e=!1,console.error("Value not supported for setting basePercentageOn: "+i.basePercentageOn)),e};return g.init=function(e){(i=f(d,e||{})).decimalPrecision=parseInt(i.decimalPrecision)||d.decimalPrecision,O()&&(m(),v())},g.getScrollPercent=function(e){if(void 0==e)return y();var t=document.querySelector(e);if(null==t)return!1;var r=x(t);return!!r&&(b(r),a)},g});